{"name":"Coleta SQL Database e Processa a Camada Bronze (RAW)","ppdf:dataflowId":"ec319468-b6e0-4c6f-b343-35d97f000ab1","ppdf:owner":{"tenantId":"a3a41932-bee6-4a4f-88e1-d2740d09b39a","userId":"c4e92428-07fc-4f27-aeb0-9fb66d9d5ee9"},"ppdf:fastCopy":true,"version":"1.0","culture":"pt-BR","modifiedTime":"2024-10-04T18:27:41.4233639+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"dbo  sleep-health":{"queryId":"d1519f30-4227-4596-8224-f0a06b794f7f","queryName":"dbo  sleep-health"},"dbo  sleep-health_DataDestination":{"queryId":"7b693287-f486-4321-8366-9afb51f11294","queryName":"dbo  sleep-health_DataDestination"},"dbo  sleep-health_WriteToDataDestination":{"queryId":"9809d68b-baae-4625-9cde-77e14654f91a","queryName":"dbo  sleep-health_WriteToDataDestination"},"dbo  sleep-health_TransformForWriteToDataDestination":{"queryId":"c0ac8594-2a0e-4a55-827d-4e8a177bf543","queryName":"dbo  sleep-health_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"5185fb53-e1b8-47ea-9b8d-9e651f393fde","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared #\"dbo  sleep-health\" = let\r\n  Origem = Sql.Databases(\"db-tcc-puc.database.windows.net\"),\r\n  Navegação = Origem{[Name = \"FabricDB\"]}[Data],\r\n  #\"Navegação 1\" = Navegação{[Schema = \"dbo.\", Item = \"sleep-health\"]}[Data],\r\n  #\"Colunas renomeadas\" = Table.RenameColumns(#\"Navegação 1\", {{\"Sleep Duration\", \"Sleep_Duration\"}, {\"Quality of Sleep\", \"Quality_of_Sleep\"}, {\"Physical Activity Level\", \"Physical_Activity_Level\"}, {\"Stress Level\", \"Stress_Level\"}, {\"BMI Category\", \"BMI_Category\"}, {\"Blood Pressure\", \"Blood_Pressure\"}, {\"Heart Rate\", \"Heart_Rate\"}, {\"Daily Steps\", \"Daily_Steps\"}, {\"Sleep Disorder\", \"Sleep_Disorder\"}, {\"Person ID\", \"Person_ID\"}})\r\nin\r\n  #\"Colunas renomeadas\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared #\"dbo  sleep-health_DataDestination\" = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"00461640-160e-4bad-8536-d70d4ec757bf\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"ea66acdf-7738-4c67-9d9b-673b49d7bd9b\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"camada_bronze\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Person_ID = nullable Text.Type, Gender = nullable Text.Type, Age = nullable Text.Type, Occupation = nullable Text.Type, Sleep_Duration = nullable Text.Type, Quality_of_Sleep = nullable Text.Type, Physical_Activity_Level = nullable Text.Type, Stress_Level = nullable Text.Type, BMI_Category = nullable Text.Type, Blood_Pressure = nullable Text.Type, Heart_Rate = nullable Text.Type, Daily_Steps = nullable Text.Type, Sleep_Disorder = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared #\"dbo  sleep-health_WriteToDataDestination\" = let\r\n  #\"dbo  sleep-health_WriteToDataDestination\" = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = #\"dbo  sleep-health_DataDestination\"], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], #\"dbo  sleep-health_TransformForWriteToDataDestination\"), Action.DoNothing}))\r\nin\r\n  #\"dbo  sleep-health_WriteToDataDestination\";\r\nshared #\"dbo  sleep-health_TransformForWriteToDataDestination\" = let\r\n    SourceTable = Table.SelectColumns(#\"dbo  sleep-health\", {\"Person_ID\", \"Gender\", \"Age\", \"Occupation\", \"Sleep_Duration\", \"Quality_of_Sleep\", \"Physical_Activity_Level\", \"Stress_Level\", \"BMI_Category\", \"Blood_Pressure\", \"Heart_Rate\", \"Daily_Steps\", \"Sleep_Disorder\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"db-tcc-puc.database.windows.net","kind":"SQL","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SQL\",\"path\":\"db-tcc-puc.database.windows.net\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}